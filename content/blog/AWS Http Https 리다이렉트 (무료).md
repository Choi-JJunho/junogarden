---
title: "AWS Http Https ë¦¬ë‹¤ì´ë ‰íŠ¸ (ë¬´ë£Œ)"
description: "ë¶€ì œ) nginxë¡œ http, https ë¦¬ë‹¤ì´ë ‰íŠ¸ êµ¬ì„±í•˜ê¸°"
date: 2024-01-31T14:07:16.070Z
tags: []
---
# ì„œë¡ 

ë™ì•„ë¦¬ ì„œë²„ë¹„ê°€ ë¶ˆí•„ìš”í•˜ê²Œ ë§ì´ ë‚˜ì˜¤ëŠ” ê²ƒ ê°™ì•„ ìš”ê¸ˆì´ ì–´ë””ì„œ ë‚˜ì˜¤ëŠ”ì§€ í™•ì¸í•´ë´¤ë‹¤.
EC2 ë¹„ìš©ì€ ê·¸ë ‡ë‹¤ ì¹˜ëŠ”ë° ELBì—ì„œ EC2 ëª»ì§€ì•Šì€ ë¹„ìš©ì´ ì§€ì¶œë˜ê³ ìˆì—ˆë‹¤.

![](/images/03d29180-b459-4f86-95de-54be5069c0bf-image.png)

![](/images/c0f6a726-a4ed-48d1-99d0-f278682787ce-image.png)

ì›” 9ë§Œì›ê°€ëŸ‰ì˜ ë¹„ìš©ì„ ì§€ì¶œí•˜ê³  ìˆëŠ” ê¼´ì´ë‹¤. ì›” 9ë§Œì›ì´ë©´ 1ë…„ì— 100ë§Œì› ì´ìƒì˜ ë¹„ìš©ì„ ì§€ë¶ˆí•˜ê³  ìˆëŠ” ì…ˆì´ë‹¤.
ë„ëŒ€ì²´ ELBë¥¼ ì–´ë””ì— ì‚¬ìš©í•˜ê³ ìˆê¸¸ë˜ ì´ë ‡ê²Œ ë§ì€ ëˆì„ ë‚´ë©´ì„œê¹Œì§€ ìœ ì§€ë¥¼ í•´ì•¼í•˜ëŠ”ê±¸ê¹Œ?

# ì‚´í´ë³´ê¸°

ì§€ê¸ˆ ë™ì•„ë¦¬ëŠ” EC2 í•˜ë‚˜ì— ELBê°€ í•˜ë‚˜ì”© ì—°ê²°ë˜ì–´ìˆëŠ” êµ¬ì¡°ë¡œ ì´ 4ê°œì˜ ELBë¥¼ ê°€ì§€ëŠ” ì¸í”„ë¼ê°€ êµ¬ì„±ë˜ì–´ìˆë‹¤.

![](/images/5c961ad8-d05a-4e65-8501-85db9630a1bc-image.png)

> ![](/images/c61f639b-7da3-4f83-a96e-d815895ae3b9-image.png)
>
> [AWS - ELB ìš”ê¸ˆí‘œ](https://aws.amazon.com/ko/elasticloadbalancing/pricing/)

ELB ìš”ê¸ˆí‘œë¥¼ í™•ì¸í•´ë³´ë©´ ì‹œê°„ë‹¹ 0.0225ë‹¬ëŸ¬

ê°œë°œì„ ì²˜ìŒ ë°°ìš°ëŠ” ë™ì•„ë¦¬ì›ë“¤ì´ HTTP -> HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸ í™˜ê²½ì„ êµ¬ì„±í•˜ê¸° ìœ„í•´ êµ¬ê¸€ë§ì„ ì—´ì‹¬íˆ í•˜ë©´ì„œ ì¸í”„ë¼ í™˜ê²½ì„ êµ¬ì¶•í–ˆì—ˆìœ¼ë¦¬ë¼ ì˜ˆìƒëœë‹¤.

ë“£ê¸°ë¡œëŠ” codeDeploy (í˜¹ì€ ë‹¤ë¥¸ ë°©ì‹) + ELBë¥¼ í™œìš©í•œ ë¬´ì¤‘ë‹¨ ë°°í¬ë¥¼ ì ìš©í•´ë³´ê¸° ìœ„í•´ ELBë¥¼ ì ìš©ì¤‘ì´ë¼ê³ í•˜ëŠ”ë° í•˜ë‚˜ë„ ì ìš©ë„ ì•ˆë˜ì–´ìˆê³  stage í™˜ê²½ê¹Œì§€ ELBê°€ ì ìš©ë˜ëŠ” ë°”ëŒì— ë¹„ìš©ì´ ê½¤ ë§ì´ ë‚˜ì˜¤ê³ ìˆë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.

## êµ¬ì„± ë‹¹ì‹œì˜ ì…ì¥ì„ ìƒê°í•´ë³´ê¸°

ì•„ë¬´ë˜ë„ ì²˜ìŒ ê°œë°œì„ í•˜ëŠ” ì…ì¥ì—ì„œëŠ” êµ¬ê¸€ë§ì— ë§ì´ ì˜ì¡´í•˜ê²Œ ë˜ëŠ” ê²ƒ ê°™ë‹¤.
ë‚´ê°€ ì•„ë¬´ê²ƒë„ ëª¨ë¥´ëŠ” ìƒí™©ì—ì„œ httpsë¥¼ ì ìš©ì‹œí‚¤ê¸° ìœ„í•´ ì–´ë–¤ ê²€ìƒ‰ì–´ë¡œ êµ¬ê¸€ì— ê²€ìƒ‰í• ê¹Œ ìƒê°í•´ë³´ì.

AWS Ec2 í™˜ê²½ì„ ì‚¬ìš©ì¤‘ì´ê³ , ëª©í‘œí•˜ëŠ” êµ¬ì„±ì€ http -> https ë¦¬ë‹¤ì´ë ‰íŠ¸ í™˜ê²½ êµ¬ì„±ì¼ ê²ƒì´ë‹¤.
ì´ì— aws, http, httpsë¼ëŠ” í‚¤ì›Œë“œë¡œ êµ¬ê¸€ë§ì„ í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê²°ê³¼ë“¤ì„ ì–»ì„ ìˆ˜ ìˆë‹¤.

![](/images/03bc9e18-15f9-4932-a761-7911d0db3849-image.png)

![](/images/669a349e-3661-4d88-9834-dcb16cec2478-image.png)

ë¡œë“œë°¸ëŸ°ì„œë¥¼ ì´ìš©í•œ ì˜ˆì‹œ ê¸€ì´ ì—„ì²­ë‚˜ê²Œ ë‚˜ì˜¤ê³  ì´ê²ƒì´ ë‹¹ì—°íˆ í‘œì¤€ì´ë¼ê³  ì°©ê°í•˜ê¸° ì‹­ìƒì´ë‹¤.
ë§ì€ ì‚¬ëŒë“¤ì´ ë´¤ìœ¼ë‹ˆê¹Œ êµ¬ê¸€ ê²€ìƒ‰ ìƒë‹¨ì— ëœ¨ê³  ì´ê²Œ ê³§ íŠ¸ë Œë“œê³  í‘œì¤€ì´ë‹¤~ í•˜ëŠ” ì˜¤í•´ë¥¼ í•  ìˆ˜ ìˆë‹¤. (ê°œë°œì„ ì²˜ìŒ ë°°ìš°ëŠ” ì´ˆë³´ë¼ë©´!)

ì´ëŸ° ê³¼ê¸ˆ ìœ„í—˜ì— ì²˜í•˜ì§€ ì•Šë„ë¡ êµë³¸(?)ìœ¼ë¡œ ì´ ê²Œì‹œê¸€ì„ ì œê³µí•˜ê³ ì ê¸€ì„ ì‘ì„±í•´ë³¸ë‹¤.

# ì‹œì‘í•˜ê¸°

> ë³¸ ì‹¤ìŠµì€ ë‹¤ìŒê³¼ ê°™ì€ í™˜ê²½ì´ êµ¬ì„±ë˜ì–´ìˆë‹¤ëŠ” ì „ì œ í•˜ì— ì§„í–‰í•©ë‹ˆë‹¤.
> 
> 1. ë„ë©”ì¸ì„ êµ¬ì…í•œ ìƒíƒœë‹¤. (ê°€ë¹„ì•„, Route53 ë“± ë­ë“  ìƒê´€ì—†ìŠµë‹ˆë‹¤)
> 2. AWS EC2ê°€ ìƒì„±ë˜ì–´ìˆê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë°°í¬ì¤‘ì´ë‹¤. (ì˜ˆë¥¼ ë“¤ì–´ SpringBoot í”„ë¡œì íŠ¸ê°€ 8080 í¬íŠ¸ì— ë– ìˆëŠ” ê·¸ëŸ° ìƒí™©ì„ ê°€ì •í•©ë‹ˆë‹¤. 
>     - í”„ë¡ íŠ¸ì—”ë“œì˜ ê²½ìš° ì•„ë˜ **ë¶€ë¡ - í”„ë¡ íŠ¸ì—”ë“œ ë°°í¬** ëª©ì°¨ì— nginx ì„¤ì •ì„ í™œìš©í•´ ì •ì íŒŒì¼ì„ ë°°í¬í•˜ëŠ” ë°©ë²•ì„ ì¶”ê°€ë¡œ ê³µìœ í•˜ë‹ˆ í•´ë‹¹ ëª©ë¡ì„ ì°¸ê³ í•´ì£¼ì‹œê¸¸ ë°”ëë‹ˆë‹¤.)
>     - (ì°¸ê³ ) í•„ìì˜ EC2ëŠ” Ubuntu 20.04.5 LTS ë²„ì „ì„ ì‚¬ìš©í•˜ê³ ìˆë‹¤.

ë„ë©”ì¸ì„ EC2ì— ì—°ê²° -> nginx config ì„¤ì • -> certbot ì„¤ì¹˜ ë° https ì„¤ì • -> crontabì„ í™œìš©í•œ ì¸ì¦ì„œ ìë™ê°±ì‹  ìˆœì„œë¡œ ì§„í–‰í•´ë³´ì.

## ë„ë©”ì¸ì„ EC2ì— ì—°ê²°

ëª©í‘œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

- https://jjbaksa.com

í•„ìì˜ ì§„í–‰ í™˜ê²½ì€ Route53ì„ ì´ìš©í•˜ì—¬ ë„ë©”ì¸ì„ ë°œê¸‰ë°›ì€ í™˜ê²½ì—ì„œ ì§„í–‰í•  ì˜ˆì •ì´ë‹¤.

![](/images/6fb3f9a3-df4b-423b-813b-2bc3f726ce86-image.png)

> ê°€ë¹„ì•„ì˜ ê²½ìš° DNS ê´€ë¦¬ íˆ´ - ì„¤ì • - ë ˆì½”ë“œ ìˆ˜ì •ì— ë“¤ì–´ê°€ì„œ ë„ë©”ì¸ ê´€ë¦¬ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë©´ ëœë‹¤.
>
>![](/images/ff58c1ae-0073-4311-af3e-c7be90b25e64-image.png)
>
> ![](/images/af4a6a9e-7cda-40e5-a171-6839564ba39e-image.png)
>
> ![](/images/c0761fa3-ca73-450e-850c-7d417cb8c3db-image.png)

![](/images/2096b97d-4382-4dc5-a826-e10899bc94f6-image.png)

ë„ë©”ì¸ì˜ A ë ˆì½”ë“œë¥¼ ìƒì„±í•œë‹¤. ì´ë•Œ ëŒ€ìƒ ê°’ì„ EC2ì˜ í¼ë¸”ë¦­ IPë¡œ í–¥í•˜ê²Œ êµ¬ì„±í•œë‹¤.
ì´ë ‡ê²Œ êµ¬ì„±í•˜ë©´ `http://ë„ë©”ì¸.com` ì£¼ì†Œë¡œ EC2ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.

> EC2 ì¸ë°”ìš´ë“œ ê·œì¹™ì— 80 í¬íŠ¸ê°€ í—ˆìš©ë˜ì–´ìˆëŠ” ìƒíƒœì¸ì§€ í™•ì¸í•´ì•¼í•œë‹¤.

## Nginx ì„¤ì •í•˜ê¸°

ë‹¨ìˆœíˆ EC2ì— ì ‘ê·¼ì€ í•  ìˆ˜ ìˆë‹¤.

> nginx ì„¤ì¹˜ê°€ ë˜ì–´ìˆì§€ ì•Šë‹¤ë©´ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ë”°ë¼ nginxë¥¼ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤.
```shell
sudo apt update
sudo apt install nginx
# nginx êµ¬ë™ìƒíƒœ í™•ì¸
sudo systemctl status nginx
```

í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ì„œë²„ë¡œ ì ‘ê·¼í–ˆì„ ë•Œ nginxê°€ ë³´ì—¬ì¤„ index.html íŒŒì¼ì„ ë§Œë“¤ê³  ì§„í–‰í•˜ì.

```shell
sudo vi /var/www/html/index.html
```

`index.html` íŒŒì¼ ë‚´ë¶€ì— ë‹¤ìŒ ë‚´ìš©ì„ ì‘ì„±í•´ë‘”ë‹¤.
```html
<!DOCTYPE HTML>
<html>
  <head>
    <title>HTTP - HTTPS</title>
  </head>
  <body>
          <h1>HTTP To HTTPS</h1>
          <p>EXAMPLE</p>
  </body>
</html>
```

ì´ì œ nginx ì„¤ì •ì„ í•´ë³´ì. nginx ì„¤ì •íŒŒì¼ì€ /etc/nginx ê²½ë¡œì— ìœ„ì¹˜í•´ìˆë‹¤.
ì„¤ì •íŒŒì¼ì„ ìƒì„±í•˜ê¸° ìœ„í•´ ì„¤ì •íŒŒì¼ì„ êµ¬ì„±í•  ìœ„ì¹˜ë¡œ ì´ë™í•œ ë’¤ íŒŒì¼ì„ ìƒì„±í•˜ì.

```shell
cd /etc/nginx/conf.d
sudo vi default.conf
```

`default.conf` íŒŒì¼ ë‚´ìš©ì— ë‹¤ìŒê³¼ ê°™ì´ ë‚´ìš©ì„ ì‘ì„±í•œë‹¤.

```shell
server {
        server_name ë„ë©”ì¸.com;
        root /var/www/html;
        index index.html;

        location / {
                try_files $uri $uri/ /index.html;
        }
}
```

> ë§Œì•½ 8080 í¬íŠ¸ì— spring ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì„±í•˜ê³ ìˆë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•  ìˆ˜ë„ ìˆë‹¤.
`cd /etc/nginx/conf.d`
`sudo vi backend.conf`
```shell
server { 
		# ì„œë¸Œë„ë©”ì¸ì„ êµ¬ì„±í•˜ë©´ ì´ë ‡ê²Œ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.
        server_name api.ë„ë©”ì¸.com;
        location / {
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header Host $http_host;
                proxy_pass http://127.0.0.1:8080;
        }
}
```

`sudo nginx -t` ëª…ë ¹ì–´ë¥¼ í†µí•´ nginx ì„¤ì •ì´ ì •ìƒì ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ìˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

![](/images/0db51ce2-7c0d-4caa-a304-5990d30411e2-image.png)

> ë§Œì•½ ì˜ëª»ëœ ë¶€ë¶„ì´ ìˆë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë¬¸ì œê°€ ë˜ëŠ” êµ¬ì„±ì— ëŒ€í•´ ì•Œë ¤ì¤€ë‹¤.
> 
> ![](/images/af24b5fd-dfed-4407-ae55-bef73098c7a5-image.png)

```shell
sudo systemctl restart nginx
```

nginx ì„¤ì •ì„ ì ìš©í•˜ê¸° ìœ„í•´ nginxë¥¼ ì¬ì‹œì‘í•´ì¤€ë‹¤.


![](/images/7d1e028d-f3ad-4b40-ba7d-ca8f8381df5f-image.png)

ì„¤ì •ì„ ì˜ êµ¬ì„±í–ˆë‹¤ë©´ `http://ë„ë©”ì¸.com`ìœ¼ë¡œ ì ‘ì†í–ˆì„ ë•Œ ë‹¤ìŒê³¼ ê°™ì€ í˜ì´ì§€ê°€ ëœ° ê²ƒì´ë‹¤.

# SSL ì¸ì¦ì„œ ë°œê¸‰ ë° Https ì„¤ì •

ì´ì œ https ì„¤ì •ì„ í•´ë³¼ ì°¨ë¡€ë‹¤.

![](/images/65679d18-f2e6-4b5d-898e-1452da1c62f3-image.png)

Let's Encryptë¼ëŠ” ê¸°ê´€ì„ í†µí•´ ì¸ì¦ì„œë¥¼ ë°œê¸‰ë°›ê³  ì´ë¥¼ ë„ë©”ì¸ì— ì ìš©í•´ë³´ì.

> Let's Encryptì—ì„œëŠ” ì¸ì¦ì„œë¥¼ ë¬´ë£Œë¡œ ë°œê¸‰í•´ì£¼ê³  ìˆê³  SSL ì¸ì¦ì„œ ì„¤ì¹˜ ë° í™˜ê²½ì„¤ì •ì„ í¸ë¦¬í•˜ê²Œ í•´ì£¼ëŠ” Certbotsë¥¼ ì œê³µí•´ì¤€ë‹¤.

ì¼ì¼íˆ ëª¨ë“  ì„¤ì •ì„ í•˜ê¸°ì—ëŠ” ì‹œê°„ì´ êµ‰ì¥íˆ ì˜¤ë˜ ê±¸ë¦¬ê¸°ë•Œë¬¸ì— certbotì„ ì´ìš©í•˜ì—¬ ì¸ì¦ì„œ ì„¤ì •ì„ í•´ë³¼ ê²ƒì´ë‹¤.

```shell
# certbotì„ ì„¤ì¹˜í•˜ê¸° ìœ„í•œ snapì„ ì„¤ì¹˜í•œë‹¤.
sudo apt update
sudo apt install snapd

# certbotì„ ì„¤ì¹˜í•œë‹¤.
sudo snap install --classic certbot
```

![](/images/02fa122b-455d-4c1f-9a16-49ed1d2e0178-image.png)

ì„¤ì¹˜ë¥¼ ì™„ë£Œí–ˆë‹¤ë©´ ì¸ì¦ì„œë¥¼ ë°œê¸‰ë°›ì„ ì°¨ë¡€ë‹¤.
ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬ ì¸ì¦ì„œë¥¼ ë°œê¸‰ë°›ì•„ë³´ì.

```shell
# certbotì„ nginxì— ì—°ê²°í•˜ê¸°
sudo certbot --nginx
```

![](/images/aa57400f-8033-4875-a809-1cffab452fc3-image.png)

ì´ë©”ì¼ ì…ë ¥ ë° ì•½ê´€ë™ì˜ë¥¼ í•˜ë©´ ìœ„ì™€ê°™ì€ í™”ë©´ì´ ë‚˜ì˜¨ë‹¤.
ìš°ë¦¬ê°€ nginxì— ì„ ì–¸í•´ë‘” server_nameì— ëŒ€í•œ ì¸ì¦ì„œ ë°œê¸‰ì„ ìˆ˜í–‰í•œë‹¤ê³  ë§í•˜ê³ ìˆë‹¤.

ì…ë ¥í•œ ë„ë©”ì¸ì´ ì—¬ëŸ¬ê°œì¸ ê²½ìš° `1,2,3...` í˜¹ì€ `1 2 3...`ë¥¼ í†µí•´ ì—¬ëŸ¬ê°œì˜ ë„ë©”ì¸ì„ ë¬¶ì–´ì„œ SSL ì¸ì¦ì„œë¥¼ ë°œê¸‰ë°›ì„ ìˆ˜ ìˆë‹¤.

![](/images/0f42e66b-ca1b-4ed3-b0ca-a54ac42b80cc-image.png)

í•„ìì˜ ê²½ìš° 2ê°œì˜ ë„ë©”ì¸ì— ëŒ€í•´ ì¸ì¦ì„œë¥¼ ë°œê¸‰ë°›ì•˜ë‹¤.

> ë§Œì•½ ë„ë©”ì¸ì„ ë” ì¶”ê°€í•˜ê³ ì‹¶ë‹¤ë©´ ì´ˆê¸°ì— A ë ˆì½”ë“œë¡œ ì„ ì–¸í•˜ëŠ” ë¶€ë¶„ë¶€í„° ë°˜ë³µí•˜ë©´ ëœë‹¤.

![](/images/d6ca88ab-3ec3-48e6-9b7c-6892c2201168-image.png)

ë°œê¸‰ì´ ì™„ë£Œë˜ë©´ ì‘ì„±í–ˆë˜ íŒŒì¼ì— certbotì´ SSL ì¸ì¦ì„œë¥¼ ì ìš©í•˜ëŠ” ì½”ë“œì™€ http -> https ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ëŠ” ì½”ë“œë¥¼ ì ìš©í•œ ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

ì´ì œ `http://ë„ë©”ì¸.com`ìœ¼ë¡œ ì ‘ì†í•˜ë©´ httpsë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë˜ëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

![](/images/468b8689-5749-46c6-9dec-ca02cb830f90-image.png)

ì¸ì¦ì„œë„ ìœ íš¨í•œ ì¸ì¦ì„œê°€ ì˜ ì ìš©ë˜ì–´ìˆëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

![](/images/af01bcb5-9f12-4002-ba74-1f5827dedc38-image.png)

ì´ë ‡ê²Œ http -> https ë¦¬ë‹¤ì´ë ‰íŠ¸ ë° ì¸ì¦ì„œ ë°œê¸‰ êµ¬ì„±ì´ ëë‚¬ë‹¤.

## Why?

certbotì´ ì–´ë–»ê²Œ ìœ íš¨í•œ ë„ë©”ì¸ì¸ì¤„ ì•Œê³  ì¸ì¦ì„œë¥¼ ë°œê¸‰í•´ì¤„ê¹Œ? ì— ëŒ€í•œ ì´ì•¼ê¸°ë¥¼ ì ì‹œ í•˜ê³  ë„˜ì–´ê°€ë ¤ê³ í•œë‹¤.

ìš°ë¦¬ëŠ” ì´ì „ ì‘ì—…ì—ì„œ ë„ë©”ì¸ì„ EC2ì— ì—°ê²°í•´ì¤¬ë‹¤.
certbotì€ ì´ ìƒí™©ì—ì„œ webroot ì¸ì¦ ë°©ì‹ì„ í†µí•´ ìœ íš¨í•œ ë„ë©”ì¸ì¸ì„ì„ íŒë‹¨í•˜ê³  ì¸ì¦ì„œë¥¼ ë°œê¸‰í•´ì¤€ë‹¤.
ê·¸ë ‡ê¸° ë•Œë¬¸ì— ìœ„ ëª…ë ¹ì–´ (`sudo certbot --nginx`)ë§Œ ìˆ˜í–‰í•´ë„ ì¸ì¦ì„œë¥¼ ë°œê¸‰ë°›ì•„ì£¼ëŠ” ê²ƒì´ë‹¤.

> webroot ì¸ì¦ ë°©ì‹: ë„ë©”ì¸ìœ¼ë¡œ ì ‘ê·¼ì„ ì‹œë„í•˜ì—¬ íŠ¹ì • ë””ë ‰í„°ë¦¬ì— ì ‘ê·¼ì´ ê°€ëŠ¥í•œì§€ í™•ì¸í•˜ëŠ” ë°©ì‹ì´ë‹¤.
- ì°¸ê³ ìë£Œ:[certbot docs - Getting certificates](https://eff-certbot.readthedocs.io/en/stable/using.html#getting-certificates-and-choosing-plugins)

> ë§Œì•½ EC2ë¡œ ì—°ê²°ë˜ì–´ìˆì§€ ì•Šì€ ë³„ë„ì˜ ë„ë©”ì¸ì„ ì¸ì¦í•˜ê³ ì‹¶ìœ¼ë©´ ì•„ë˜ ê²Œì‹œê¸€ì„ ì°¸ê³ í•´ë´ë„ ì¢‹ë‹¤.
- https://https://pium-official.github.io/update-ssl/

# ì¸ì¦ì„œ ê°±ì‹  ìë™í™”

Let's Encryptì—ì„œ ë°œê¸‰í•´ì£¼ëŠ” ì¸ì¦ì„œëŠ” ë¬´ë£Œ ì¸ì¦ì„œë¡œ 3ê°œì›”ì˜ ìœ íš¨ê¸°ê°„ì„ ê°€ì§€ê³ ìˆë‹¤.

> `sudo certbot certificates` ëª…ë ¹ì–´ë¡œ ì¸ì¦ì„œ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
![](/images/25d3ed1c-d460-4990-aab8-1d21b85a1513-image.png)

3ê°œì›”ë§ˆë‹¤ ì„œë²„ì— ë“¤ì–´ì™€ì„œ ì¸ì¦ì„œë¥¼ ë°œê¸‰í•´ì£¼ëŠ” ì¼ì€ ì—¬ê°„ ë²ˆê±°ë¡œìš´ì¼ì´ë‹¤.
crontabê³¼ certbotì„ ì´ìš©í•˜ì—¬ ì¸ì¦ì„œë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ ìë™ê°±ì‹ í•˜ëŠ” ì„¤ì •ì„ í•´ë³´ì.

ìš°ì„  ì„œë²„ ì‹œê°„ì„ í™•ì¸í•´ë³´ì.

```shell
timedatectl
```

![](/images/d8879345-6cb6-426f-ab41-e03a283324ff-image.png)

> ë§Œì•½ UTCë¡œ ì„¤ì •ë˜ì–´ìˆê³  í•œêµ­ ê¸°ì¤€ìœ¼ë¡œ ë§ì¶°ì£¼ê³  ì‹¶ë‹¤ë©´ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì.
`sudo timedatectl set-timezone Asia/Seoul`

ìŠ¤ì¼€ì¤„ë§ì„ ìœ„í•´ crontabì— ì‘ì—…ì„ ë“±ë¡í•œë‹¤.

```shell
# crontab ì—´ê¸°
sudo crontab -e 
```
![](/images/92dc0b28-c831-4476-be2c-7a35ab57fbe3-image.png)

ë§ˆì§€ë§‰ì¤„ì— ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì¶”ê°€í•´ê³  ì €ì¥í•˜ë©´ ë§¤ì›” 1ì¼ ì˜¤ì „ 3ì‹œì— ì¸ì¦ì„œê°€ ê°±ì‹ ëœë‹¤.
`0 3 1 * * /usr/bin/certbot renew --renew-hook="sudo systemctl restart nginx"`
![](/images/f7c3c597-6bc5-4f24-825d-1feca12cee60-image.png)

# í›„ê¸°

stage í™˜ê²½ì˜ ë¶ˆí•„ìš”í•œ ELB ì„¤ì •ì„ ì œê±°í•˜ë©´ì„œ nginxë¥¼ ì´ìš©í•œ https ì„¤ì •ë°©ì‹ì„ ì •ë¦¬í•´ë´¤ë‹¤.
ë¹„ìš© ì ˆê°ì„ ìœ„í•´ ê°€ê¸‰ì  stage í™˜ê²½ í˜¹ì€ ì‘ì€ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ê·œëª¨ì—ì„œëŠ” ë¶ˆí•„ìš”í•œ ì„¤ì •ì„ ì œê±°í•  ìˆ˜ ìˆë„ë¡ í•˜ì.

![](/images/b31e826a-9e3f-4da4-8e2b-6ef2dd3f4d78-image.png)

ëˆ ì•„ë¼ë©´ì„œ ì¦ê²ê²Œ ê°œë°œí•˜ì ğŸ˜‡ ğŸ’¸